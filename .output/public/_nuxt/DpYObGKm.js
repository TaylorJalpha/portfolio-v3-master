import{e as H,G as C,k as z,a3 as w,M as U,c as W,a4 as j,a5 as q,f as B,s as G,H as L,a6 as v,a7 as J,a8 as Q,a9 as X,v as S,x as Y,g as Z,aa as x,ab as K,a0 as k,j as A,ac as ee}from"#entry";import{f as R}from"./BgxJxo-z.js";const ae={trailing:!0};function te(e,a=25,i={}){if(i={...ae,...i},!Number.isFinite(a))throw new TypeError("Expected `wait` to be a finite number");let n,t,r=[],s,u;const l=(o,g)=>(s=se(e,o,g),s.finally(()=>{if(s=null,i.trailing&&u&&!t){const h=l(o,u);return u=null,h}}),s),m=function(...o){return i.trailing&&(u=o),s||new Promise(g=>{const h=!t&&i.leading;clearTimeout(t),t=setTimeout(()=>{t=null;const d=i.leading?n:l(this,o);u=null;for(const p of r)p(d);r=[]},a),h?(n=l(this,o),g(n)):r.push(g)})},c=o=>{o&&(clearTimeout(o),t=null)};return m.isPending=()=>!!t,m.cancel=()=>{c(t),r=[],u=null},m.flush=()=>{if(c(t),!u||s)return;const o=u;return u=null,l(this,o)},m}async function se(e,a,i){return await e.apply(a,i)}const F=Symbol.for("nuxt:client-only"),de=H({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(e,{slots:a,attrs:i}){const n=C(!1);z(()=>{n.value=!0});const t=j();return t&&(t._nuxtClientOnly=!0),q(F,!0),()=>{if(n.value){const l=a.default?.();return l&&l.length===1?[w(l[0],i)]:l}const r=a.fallback||a.placeholder;if(r)return U(r);const s=e.fallback||e.placeholder||"",u=e.fallbackTag||e.placeholderTag||"span";return W(u,i,s)}}}),ne=e=>e==="defer"||e===!1;function fe(...e){const a=typeof e[e.length-1]=="string"?e.pop():void 0;re(e[0],e[1])&&e.unshift(a);let[i,n,t={}]=e;const r=B(()=>G(i));if(typeof r.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof n!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const s=L();t.server??=!0,t.default??=ie,t.getCachedData??=N,t.lazy??=!1,t.immediate??=!0,t.deep??=v.deep,t.dedupe??="cancel",t._functionName,s._asyncData[r.value];const u={cause:"initial",dedupe:t.dedupe};s._asyncData[r.value]?._init||(u.cachedData=t.getCachedData(r.value,s,{cause:"initial"}),s._asyncData[r.value]=V(s,r.value,n,t,u.cachedData));const l=s._asyncData[r.value];l._deps++;const m=()=>s._asyncData[r.value].execute(u),c=t.server!==!1&&s.payload.serverRendered;{let h=function(f){const _=s._asyncData[f];_?._deps&&(_._deps--,_._deps===0&&_?._off())};const d=j();if(d&&c&&t.immediate&&!d.sp&&(d.sp=[]),d&&!d._nuxtOnBeforeMountCbs){d._nuxtOnBeforeMountCbs=[];const f=d._nuxtOnBeforeMountCbs;J(()=>{f.forEach(_=>{_()}),f.splice(0,f.length)}),Q(()=>f.splice(0,f.length))}const p=d&&(d._nuxtClientOnly||X(F,!1));c&&s.isHydrating&&(l.error.value||l.data.value!=null)?(l.pending.value=!1,l.status.value=l.error.value?"error":"success"):d&&(!p&&s.payload.serverRendered&&s.isHydrating||t.lazy)&&t.immediate?d._nuxtOnBeforeMountCbs.push(m):t.immediate&&m();const y=ee(),D=S(r,(f,_)=>{if((f||_)&&f!==_){const O=s._asyncData[_]?.data.value!==v.value,$=s._asyncDataPromises[_]!==void 0;_&&h(_);const E={cause:"initial",dedupe:t.dedupe};if(!s._asyncData[f]?._init){let b;_&&O?b=s._asyncData[_]?.data.value:(b=t.getCachedData(f,s,{cause:"initial"}),E.cachedData=b),s._asyncData[f]=V(s,f,n,t,b)}s._asyncData[f]._deps++,(t.immediate||O||$)&&s._asyncData[f].execute(E)}},{flush:"sync"}),T=t.watch?S(t.watch,()=>{l._execute({cause:"watch",dedupe:t.dedupe})}):()=>{};y&&Y(()=>{D(),T(),h(r.value)})}const o={data:P(()=>s._asyncData[r.value]?.data),pending:P(()=>s._asyncData[r.value]?.pending),status:P(()=>s._asyncData[r.value]?.status),error:P(()=>s._asyncData[r.value]?.error),refresh:(...h)=>s._asyncData[r.value].execute(...h),execute:(...h)=>s._asyncData[r.value].execute(...h),clear:()=>M(s,r.value)},g=Promise.resolve(s._asyncDataPromises[r.value]).then(()=>o);return Object.assign(g,o),g}function P(e){return B({get(){return e()?.value},set(a){const i=e();i&&(i.value=a)}})}function re(e,a){return!(typeof e=="string"||typeof e=="object"&&e!==null||typeof e=="function"&&typeof a=="function")}function M(e,a){a in e.payload.data&&(e.payload.data[a]=void 0),a in e.payload._errors&&(e.payload._errors[a]=v.errorValue),e._asyncData[a]&&(e._asyncData[a].data.value=void 0,e._asyncData[a].error.value=v.errorValue,e._asyncData[a].pending.value=!1,e._asyncData[a].status.value="idle"),a in e._asyncDataPromises&&(e._asyncDataPromises[a]&&(e._asyncDataPromises[a].cancelled=!0),e._asyncDataPromises[a]=void 0)}function ce(e,a){const i={};for(const n of a)i[n]=e[n];return i}function V(e,a,i,n,t){e.payload._errors[a]??=v.errorValue;const r=n.getCachedData!==N,s=i,u=n.deep?Z:C,l=t!=null,m=e.hook("app:data:refresh",async o=>{(!o||o.includes(a))&&await c.execute({cause:"refresh:hook"})}),c={data:u(l?t:n.default()),pending:C(!l),error:x(e.payload._errors,a),status:C("idle"),execute:(...o)=>{const[g,h=void 0]=o,d=g&&h===void 0&&typeof g=="object"?g:{};if(e._asyncDataPromises[a]){if(ne(d.dedupe??n.dedupe))return e._asyncDataPromises[a];e._asyncDataPromises[a].cancelled=!0}if(d.cause==="initial"||e.isHydrating){const y="cachedData"in d?d.cachedData:n.getCachedData(a,e,{cause:d.cause??"refresh:manual"});if(y!=null)return e.payload.data[a]=c.data.value=y,c.error.value=v.errorValue,c.status.value="success",Promise.resolve(y)}c.pending.value=!0,c.status.value="pending";const p=new Promise((y,D)=>{try{y(s(e))}catch(T){D(T)}}).then(async y=>{if(p.cancelled)return e._asyncDataPromises[a];let D=y;n.transform&&(D=await n.transform(y)),n.pick&&(D=ce(D,n.pick)),e.payload.data[a]=D,c.data.value=D,c.error.value=v.errorValue,c.status.value="success"}).catch(y=>{if(p.cancelled)return e._asyncDataPromises[a];c.error.value=k(y),c.data.value=A(n.default()),c.status.value="error"}).finally(()=>{p.cancelled||(c.pending.value=!1,delete e._asyncDataPromises[a])});return e._asyncDataPromises[a]=p,e._asyncDataPromises[a]},_execute:te((...o)=>c.execute(...o),0,{leading:!0}),_default:n.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{m(),e._asyncData[a]?._init&&(e._asyncData[a]._init=!1),r||K(()=>{e._asyncData[a]?._init||(M(e,a),c.execute=()=>Promise.resolve(),c.data.value=v.value)})}};return c}const ie=()=>v.value,N=(e,a,i)=>{if(a.isHydrating)return a.payload.data[e];if(i.cause!=="refresh:manual"&&i.cause!=="refresh:hook")return a.static.data[e]};function le(e){return e&&(e.meta_description||(typeof e.metadata=="string"?e.metadata:e.metadata?.description)||e.seo?.description||e.description)||""}function I(e){if(!e)return e;const a=e.slug?.current||e.slug;return e?.pdfFile?.asset&&(e.pdfFile.asset.url=e.pdfFile.asset.url||e.pdfFile.asset._ref||""),{...e,slug:a,content_type:e._type||e.content_type,featured_image_url:e.featuredImage?.asset?.url||e.featured_image_url,gallery_images:e.galleryImages||e.gallery_images||[]}}const _e=()=>({fetchPortfolioItems:async(n={})=>{let t="";n.content_type&&(t+=` && _type == "${n.content_type}"`),n.tag&&(t+=` && "${n.tag}" in tags[]->title`);const r=((n.page||1)-1)*(n.per_page||12),s=r+(n.per_page||12),u=`*[_type in ["project", "caseStudy", "blogPost"] && !(_id in path('drafts.**'))${t}] | order(published_at desc) [${r}...${s}] { _id, title, description, meta_description, metadata, seo{ description }, slug, _type, featuredImage{ asset->{_id, url} }, tags[]->{ _id, title }, published_at, external_url }`,l=await R(u),c=(Array.isArray(l)?l:l?.data||[]).map(o=>I(o));return{data:c,meta:{current_page:n.page||1,per_page:n.per_page||12,total_count:c.length,has_more:c.length===(n.per_page||12)}}},fetchPortfolioItem:async n=>{const t=`*[_type in ["project", "caseStudy", "blogPost"] && !(_id in path('drafts.**')) && (slug.current == "${n}" || _id == "${n}")][0]{ _id, title, description, meta_description, metadata, seo{ description }, slug, _type, featuredImage{ asset->{_id, url} }, tags[]->{ _id, title }, published_at, external_url, content, markdown, galleryImages, pdfFile{ asset->{url,_ref} } }`,r=await R(t);return{data:I(r)}},fetchTags:async()=>[],resolveMetaDescription:le,normalizeItem:I});export{de as _,_e as a,I as n,le as r,fe as u};
